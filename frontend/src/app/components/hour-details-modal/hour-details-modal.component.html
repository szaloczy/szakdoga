<div class="modal-backdrop" *ngIf="show" (click)="handleClose()"></div>
<div class="modal-dialog modal-lg" *ngIf="show">
  <div class="modal-content">
    <div class="modal-header bg-primary text-white">
      <h5 class="modal-title">
        <i class="bi bi-clock-history me-2"></i>
        {{ student.firstname }} {{ student.lastname }} - {{ 'mentor_students.actions.view_hours' | translate }}
      </h5>
      <button type="button" class="btn-close" aria-label="Close" (click)="handleClose()"></button>
    </div>
    <div class="modal-body">
      <div class="row mb-3">
        <div class="col-3">
          <div class="card bg-light">
            <div class="card-body text-center">
              <h6 class="card-title">{{ 'internship_hours.stats.total' | translate }}</h6>
              <h4 class="text-primary">{{ totalHours | number:'1.1-1' }}</h4>
            </div>
          </div>
        </div>
        <div class="col-3">
          <div class="card bg-light">
            <div class="card-body text-center">
              <h6 class="card-title">{{ 'internship_hours.stats.approved' | translate }}</h6>
              <h4 class="text-success">{{ approvedHours | number:'1.1-1' }}</h4>
            </div>
          </div>
        </div>
        <div class="col-3">
          <div class="card bg-light">
            <div class="card-body text-center">
              <h6 class="card-title">{{ 'internship_hours.stats.pending' | translate }}</h6>
              <h4 class="text-warning">{{ pendingHours | number:'1.1-1' }}</h4>
            </div>
          </div>
        </div>
        <div class="col-3">
          <div class="card bg-light">
            <div class="card-body text-center">
              <h6 class="card-title">{{ 'internship_hours.stats.left' | translate }}</h6>
              <h4 class="text-info">{{ remainingHours | number:'1.1-1' }}</h4>
            </div>
          </div>
        </div>
      </div>
      <div class="progress mb-3" style="height: 20px;">
        <div class="progress-bar bg-success" role="progressbar" 
             [style.width]="(approvedHours / 180) * 100 + '%'">
         {{ (approvedHours / 180) * 100 | number:'1.1-1' }}%
        </div>
        <div class="progress-bar bg-warning" role="progressbar" 
             [style.width]="(pendingHours / 180) * 100 + '%'">
         {{ (pendingHours / 180) * 100 | number:'1.1-1' }}%
        </div>
      </div>
      <hr>
      <h6>{{ 'mentor_students.actions.view_hours' | translate }}</h6>
      <div class="list-group" style="max-height: 300px; overflow-y: auto;">
        <ng-container *ngIf="hoursList.length > 0; else noEntries">
          <div *ngFor="let hour of hoursList.slice(0, 10)" class="list-group-item d-flex justify-content-between align-items-center">
            <div>
              <strong>{{ hour.date | date:'mediumDate' }}</strong><br>
              <small class="text-muted">{{ hour.description || ('internship_hours.add_hour_box.desc' | translate) }}</small>
            </div>
            <div class="text-end">
              <span class="badge" [ngClass]="{
                'bg-success': hour.status === 'approved',
                'bg-warning': hour.status === 'pending',
                'bg-danger': hour.status === 'rejected'
              }" style="border-radius: 1rem;">
                {{ hour.hours }}h - {{ hour.status }}
              </span>
              <ng-container *ngIf="hour.status === 'pending'">
                <button class="btn btn-sm btn-outline-success me-2" (click)="emitApproveHour(hour.id)">
                  <i class="bi bi-check-circle"></i> {{ 'internship_hours.actions.approve' | translate }}
                </button>
                <button class="btn btn-sm btn-outline-danger ms-2" (click)="emitRejectHour(hour.id)">
                  <i class="bi bi-x-circle"></i> {{ 'internship_hours.actions.reject' | translate }}
                </button>
              </ng-container>
            </div>
          </div>
        </ng-container>
        <ng-template #noEntries>
          <div class="text-center text-muted py-3">{{ 'internship_hours.entries.no_entries_found' | translate }}</div>
        </ng-template>
      </div>
      <div class="mt-3 text-center">
        <small class="text-muted">
          <i class="bi bi-info-circle"></i>
          {{ 'internship_hours.entries.hours_entries' | translate }}
        </small>
      </div>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-secondary" (click)="handleClose()">{{ 'buttons.forms.cancel.text' | translate }}</button>
    </div>
  </div>
</div>
